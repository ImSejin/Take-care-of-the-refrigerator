<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.web.server.repo.HardEasyDao">

    <!-- 1은  hard 2는 easy -->
    <update id="hardEasyChoice" parameterType="hardEasy">

--         update hardeasy set grade = 1 WHERE board_id=#{boardId} AND user_id=(select user_id from users WHERE email=#{email})

        <set>
            <choose>
                <when test="grade==1">
                    grade=0
                </when>
                <when test="#grade==2 or grade==0">
                    grade=#{pressedBtn}
                </when>
                <when test=" grade==2">
                    grade=0
                </when>
                <when test="grade==1 or grade==0">
                    grade=#{pressedBtn}
                </when>
            </choose>
        </set>
        WHERE board_id=#{boardId} AND user_id=(select user_id from users WHERE email=#{email})
    </update>

    <insert id="firstChoice" parameterType="hardEasy">
         INSERT INTO hardeasy(board_id,user_id,grade)
         <if test="pressedBtn == 1">
             VALUES(#{boardId},(select user_id from users WHERE email=#{email}),1)
         </if>
         <if test="pressedBtn == 2">
             VALUES (#{boardId},(select user_id from users WHERE email=#{email}),2)
         </if>
    </insert>

    <select id="checkChoice" resultType="hardEasy">
        select * from hardeasy WHERE board_id=#{boardId} AND user_id=(select user_id from users WHERE email=#{email})
    </select>

<!--    <select id="easyToHardChangeChoice">-->
<!--        UPDATE hardeasy-->
<!--        SET grade = 1-->
<!--        WHERE board_id=#{boardId} AND user_id=(select user_id from users WHERE email=#{email})-->
<!--    </select>-->

<!--    <select id="hardToEasyChangeChoice">-->
<!--        UPDATE hardeasy-->
<!--        SET grade = 2-->
<!--        WHERE board_id=#{boardId} AND user_id=(select user_id from users WHERE email=#{email})-->
<!--    </select>-->

<!--    <insert id="easyChoice">-->
<!--        INSERT INTO hardeasy (board_id,user_id,grade)-->
<!--        VALUES (#{boardId},(select user_id from users WHERE email=#{email}),2)-->
<!--    </insert>-->
<!--    <delete id="deleteChoice">-->
<!--        DELETE FROM hardeasy-->
<!--        WHERE board_id=#{boardId} AND user_id=(select user_id from users WHERE email=#{email})-->
<!--    </delete>-->


</mapper>
